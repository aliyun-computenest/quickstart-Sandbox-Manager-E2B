{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5728ACS\u96c6\u7fa4\u4e2d\u4f7f\u7528 E2B \u7ba1\u7406\u5b89\u5168\u6c99\u7bb1 \u6982\u8ff0 E2B \u662f\u4e00\u4e2a\u6d41\u884c\u7684\u5f00\u6e90\u5b89\u5168\u6c99\u7bb1\u6846\u67b6\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u7b80\u5355\u6613\u7528\u7684 Python \u4e0e JavaScript SDK \u4f9b\u7528\u6237\u5bf9\u5b89\u5168\u6c99\u7bb1\u8fdb\u884c\u521b\u5efa\u3001\u67e5\u8be2\u3001\u6267\u884c\u4ee3\u7801\u3001\u8bf7\u6c42\u7aef\u53e3\u7b49\u64cd\u4f5c\u3002 acs-sandbox-manager\u7ec4\u4ef6\u662f\u4e00\u4e2a\u517c\u5bb9 E2B \u534f\u8bae\u7684\u540e\u7aef\u5e94\u7528\uff0c\u4f7f\u7528\u6237\u5728\u4efb\u4f55 K8s \u96c6\u7fa4\u4e2d\u4e00\u952e\u642d\u5efa\u4e00\u4e2a\u6027\u80fd\u5ab2\u7f8e\u539f\u751f E2B \u7684\u6c99\u7bb1\u57fa\u7840\u8bbe\u65bd\u3002 \u672c\u670d\u52a1\u63d0\u4f9b\u4e86\u5728ACS \u96c6\u7fa4\u4e2d\u5feb\u901f\u642d\u5efa\u5b89\u5168\u6c99\u7bb1\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u652f\u6301\u4f7f\u7528 E2B \u534f\u8bae\u8fdb\u884c\u4ea4\u4e92\u3002 \u524d\u63d0\u51c6\u5907 \u6807\u51c6\u7684 E2B \u534f\u8bae\u9700\u8981\u4e00\u4e2a\u57df\u540d\uff08E2B_DOMAIN\uff09\u6765\u6307\u5b9a\u540e\u7aef\u670d\u52a1\u3002\u4e3a\u6b64\uff0c\u60a8\u9700\u8981\u51c6\u5907\u4e00\u4e2a\u81ea\u5df1\u7684\u57df\u540d\u3002 E2B \u5ba2\u6237\u7aef\u5fc5\u987b\u901a\u8fc7 HTTPS \u534f\u8bae\u8bf7\u6c42\u540e\u7aef\uff0c\u5e76\u4e14\u6bcf\u6b21\u8bf7\u6c42\u7684\u5b50\u57df\u540d\u90fd\u53ef\u80fd\u4e0d\u540c\uff0c\u56e0\u6b64\u8fd8\u9700\u8981\u4e3a\u670d\u52a1\u7533\u8bf7\u4e00\u4e2a\u901a\u914d\u7b26\u8bc1\u4e66\u3002 \u51c6\u5907\u57df\u540d \u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u57df\u540d\uff0c\u53ef\u4ee5\u53c2\u8003\u6587\u6863 \u57df\u540d\u6ce8\u518c\u5feb\u901f\u5165\u95e8 \u6ce8\u518c\u4e00\u4e2a\u81ea\u5df1\u7684\u57df\u540d\u3002 \u5982\u679c\u60a8\u7684\u670d\u52a1\u90e8\u7f72\u5728\u4e2d\u56fd\u5185\u5730\uff0c\u8fd8\u9700\u8981\u4e3a\u57df\u540d\u8fdb\u884c\u5907\u6848\uff0c\u53c2\u8003\u6587\u6863\uff1a \u57df\u540d\u5907\u6848 \u3002 \u83b7\u53d6\u6cdb\u57df\u540d\u901a\u914d\u7b26\u8bc1\u4e66 \u5728\u751f\u4ea7\u573a\u666f\u4e0b\uff0c\u63a8\u8350\u60a8\u53c2\u8003\u6587\u6863 \u8d2d\u4e70\u6b63\u5f0f\u8bc1\u4e66 \u7533\u8bf7\u4e00\u4e2a\u6b63\u5f0f\u7684\u901a\u914d\u7b26\u57df\u540d\u8bc1\u4e66\u3002 \u5728\u6d4b\u8bd5\u573a\u666f\u4e0b\uff0c\u60a8\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u6b65\u9aa4\u901a\u8fc7 Let's Encrypt \u7533\u8bf7\u4e00\u4e2a\u514d\u8d39\u7684\u6d4b\u8bd5\u8bc1\u4e66\u3002 1. \u901a\u8fc7\u7cfb\u7edf\u7684\u5305\u7ba1\u7406\u5668\uff08brew\u3001snap \u7b49\uff09\u5b89\u88c5 certbot\uff0c\u66f4\u591a\u5b89\u88c5\u4fe1\u606f\u8bf7\u67e5\u770b \u5b98\u65b9\u6587\u6863 \u3002 2. \u53c2\u8003\u4ee5\u4e0b\u547d\u4ee4\uff0c\u4fee\u6539 -d \u4e0e --email \u7684\u53c2\u6570\u4e3a\u6cdb\u57df\u540d*.your.domain.cn \u7533\u8bf7\u901a\u914d\u7b26\u8bc1\u4e66\u3002\u8bf7\u6839\u636e\u547d\u4ee4\u7684\u63d0\u793a\u8fdb\u884c\u9a8c\u8bc1\u64cd\u4f5c\u3002 $ sudo certbot certonly \\ --manual \\ --preferred-challenges=dns \\ --email your-email@example.com \\ --server https://acme-v02.api.letsencrypt.org/directory \\ --agree-tos \\ -d \"*.your.domain.cn\" \u5bfc\u51fa\u8bc1\u4e66 $ sudo cp /etc/letsencrypt/live/your.domain/fullchain.pem ./fullchain.pem $ sudo cp /etc/letsencrypt/live/your.domain/privkey.pem ./privkey.pem \u90e8\u7f72\u6d41\u7a0b \u6253\u5f00\u8ba1\u7b97\u5de2\u670d\u52a1 \u90e8\u7f72\u94fe\u63a5 \u586b\u5199\u76f8\u5173\u90e8\u7f72\u53c2\u6570\u3001\u9009\u62e9\u90e8\u7f72\u5730\u57df\u3001ACS\u96c6\u7fa4\u7684Service CIDR, \u4e13\u6709\u7f51\u7edc\u914d\u7f6e \u586b\u5199E2B \u57df\u540d\u914d\u7f6e\uff0cE2B\u7684\u8bbf\u95ee\u57df\u540d\u914d\u7f6e\u4e3a\u4e0a\u8ff0\u524d\u63d0\u51c6\u5907\u9636\u6bb5\u7684\u57df\u540d\uff0c TLS \u8bc1\u4e66\u9009\u62e9fullchain.pem\u6587\u4ef6 TLS \u8bc1\u4e66\u79c1\u94a5\u9009\u62e9privkey.pem\u6587\u4ef6 4.\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u70b9\u51fb\u786e\u8ba4\u8ba2\u5355 \u4f7f\u7528\u6c99\u7bb1 \u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a\u5bf9\u5e94\u7684ACS\u96c6\u7fa4\uff0cACS\u96c6\u7fa4\u4e2d\u5728sandbox-system\u547d\u540d\u7a7a\u95f4\u4e0b\u6709sandbox-manager\u7684Deployment\uff0c\u7528\u4e8e\u7ba1\u7406\u6c99\u7bb1 \u521b\u5efa\u51fa\u6765\u7684\u6c99\u7bb1\uff0c\u4f1a\u5728default \u547d\u540d\u7a7a\u95f4\u4e0b \u914d\u7f6e\u57df\u540d\u7684\u89e3\u6790 \u96c6\u7fa4\u4e2d\u4f7f\u7528MSE \u7f51\u5173\u4f5c\u4e3aIngress\uff0c\u5728 MSE\u63a7\u5236\u53f0 \u627e\u5230ACS\u96c6\u7fa4\u521b\u5efa\u51fa\u6765\u7684\u7f51\u5173\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u7b7e\u6765\u67e5\u627e \u83b7\u53d6\u5230MSE\u7f51\u5173\u7684\u516c\u7f51\u57df\u540d \u8bf7\u5c06\u4e3b\u673a\u8bb0\u5f55 *.your.domain.cn \u4ee5 CNAME \u8bb0\u5f55\u7c7b\u578b\u89e3\u6790\u5230\u5bf9\u5e94\u57df\u540d\u3002 \u4f7f\u7528\u6c99\u7bb1demo acs-sandbox-manager \u7ec4\u4ef6\u6682\u65f6\u53ea\u652f\u6301\u4ee5\u4e0b\u4e09\u4e2a\u5185\u7f6e\u7684\u6a21\u677f\uff1a 1. code-interpreter\uff1aE2B \u5b98\u65b9\u7684 code-interpreter \u955c\u50cf\uff0c\u53ef\u4ee5\u6267\u884c Python \u4ee3\u7801\u3002 2. desktop\uff1aE2B \u5b98\u65b9\u7684 desktop \u955c\u50cf\uff0c\u7528\u4e8e\u901a\u8fc7 e2b_desktop \u5e93\u8fdc\u7a0b\u64cd\u4f5c\u56fe\u5f62\u684c\u9762\u3002 3. browser\uff1aGoogle \u5b98\u65b9\u7684 headless-shell \u955c\u50cf\uff0c\u4e3a browser_use \u7b49\u5e94\u7528\u63d0\u4f9b\u4e86 Chrome \u6d4f\u89c8\u5668\u73af\u5883\u3002 \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf export E2B_DOMAIN=your.domain.cn \u6267\u884c\u4ee3\u7801 \u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u521b\u5efa\u6c99\u7bb1\u3001\u6267\u884c\u4ee3\u7801\u3001\u8bfb\u5199\u6587\u4ef6\u3001\u9500\u6bc1\u6c99\u7bb1\u7b49\u57fa\u672c\u529f\u80fd\u3002 import os # Import the E2B SDK from e2b_code_interpreter import Sandbox # Create a sandbox using the E2B Python SDK sbx = Sandbox.create(template=\"code-interpreter\", timeout=300) print(f\"sandbox id: {sbx.sandbox_id}\") def execute_python_code(s: Sandbox, code: str): # Execute Python code inside the sandbox execution = s.run_code(code) if execution.error: print(f\"Error executing code: {execution.error}\") else: print(execution.logs.stdout) execute_python_code(sbx, \"print('hello world')\") execute_python_code(sbx, \"a = 1\") execute_python_code(sbx, \"b = 2\") execute_python_code(sbx, \"print(a + b)\") execute_python_code(sbx, \"\"\" def bubble_sort(arr): n = len(arr) # \u521b\u5efa\u6570\u7ec4\u526f\u672c\uff0c\u907f\u514d\u4fee\u6539\u539f\u6570\u7ec4 sorted_arr = arr.copy() # \u5916\u5c42\u5faa\u73af\u63a7\u5236\u6392\u5e8f\u8f6e\u6570 for i in range(n): # \u6807\u8bb0\u672c\u8f6e\u662f\u5426\u53d1\u751f\u4ea4\u6362 swapped = False # \u5185\u5c42\u5faa\u73af\u8fdb\u884c\u76f8\u90bb\u5143\u7d20\u6bd4\u8f83 for j in range(0, n - i - 1): # \u5982\u679c\u524d\u4e00\u4e2a\u5143\u7d20\u5927\u4e8e\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5219\u4ea4\u6362 if sorted_arr[j] > sorted_arr[j + 1]: sorted_arr[j], sorted_arr[j + 1] = sorted_arr[j + 1], sorted_arr[j] swapped = True # \u5982\u679c\u672c\u8f6e\u6ca1\u6709\u53d1\u751f\u4ea4\u6362\uff0c\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u6709\u5e8f\uff0c\u53ef\u4ee5\u63d0\u524d\u7ed3\u675f if not swapped: break return sorted_arr print(bubble_sort([1,6,4,2,3,7,5])) \"\"\") # List files in the sandbox try: # Read local file relative to the current working directory with open(os.path.abspath(__file__), \"rb\") as file: sbx.files.write(\"/home/user/my-file\", file) file_content = sbx.files.read(\"/home/user/my-file\") print(file_content) except Exception as e: # Print the full stack trace for debugging import traceback traceback.print_exc() print(f\"Error listing files: {e}\") raise e finally: sbx.kill() print(f\"sandbox {sbx.sandbox_id} killed\") \u9884\u671f\u8f93\u51fa sandbox id: code-interpreter-5df5b8dd48-dpxjb ['hello world\\n'] [] [] ['3\\n'] ['[1, 2, 3, 4, 5, 6, 7]\\n'] \u63a7\u5236\u684c\u9762 \u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u7533\u8bf7\u6c99\u7bb1\u3001\u542f\u52a8\u7a0b\u5e8f\u3001\u952e\u76d8\u8f93\u5165\u3001\u9500\u6bc1\u6c99\u7bb1\u7b49\u57fa\u672c\u529f\u80fd\u3002 \u6a21\u677f\u4ec5\u5185\u7f6e\u4e86\u4e00\u4e2a\u672a\u4f18\u5316\u7684\u684c\u9762\u73af\u5883\uff0c\u542f\u52a8\u65f6\u4f1a\u6709\u4e00\u4e9b\u5f39\u7a97\uff0c\u9700\u8981\u901a\u8fc7\u4e32\u6d41\u624b\u52a8\u5173\u95ed\u540e\u518d\u6267\u884c Chrome \u8bbf\u95ee\u767e\u5ea6\u7684\u81ea\u52a8\u5316\u64cd\u4f5c\u3002 import time from e2b_desktop import Sandbox # Create a new desktop sandbox desktop = Sandbox.create(api_key=\"GG\", template=\"desktop\") print(f\"sandboxId: {desktop.sandbox_id}\") # Launch an application desktop.launch('google-chrome') # or vscode, firefox, etc. print(\"waiting 5 seconds for desktop launching\") time.sleep(5) # Stream the application's window # Note: There can be only one stream at a time # You need to stop the current stream before streaming another application desktop.stream.start( # window_id=desktop.get_current_window_id(), # if not provided the whole desktop will be streamed require_auth=True ) # Get the stream auth key auth_key = desktop.stream.get_auth_key() # Print the stream URL print('Stream URL:', desktop.stream.get_url(auth_key=auth_key)) input(\"select the address bar and press ENTER to visit baidu.com\") desktop.write(\"www.baidu.com\") time.sleep(0.5) desktop.press(\"enter\") input(\"press ENTER to exit\") # Kill the sandbox after the tasks are finished desktop.kill() \u7b49\u5f85\u684c\u9762\u4e32\u6d41\u542f\u52a8 sandboxId: desktop-7c84c88b8-tpjmg waiting 5 seconds for desktop launching Stream URL: https://6080-desktop-7c84c88b8-tpjmg.your.domain/vnc.html?autoconnect=true&resize=scale&password=***** select the address bar and press ENTER to visit baidu.com \u8bbf\u95ee Stream URL\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6253\u5f00\u4e86 Chrome \u7684 Linux \u684c\u9762 \u56de\u5230\u7ec8\u7aef\u6572\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u684c\u9762\u81ea\u52a8\u6253\u5f00\u4e86\u767e\u5ea6\u3002 \u63a7\u5236\u6d4f\u89c8\u5668 \u5185\u7f6e\u6a21\u677fbrowser\u662f\u4ee5 E2B Sandbox \u5f62\u5f0f\u900f\u51fa\uff0c\u517c\u5bb9\u5f00\u6e90\u9879\u76eebrowser_use\u7684\u6d4f\u89c8\u5668\u73af\u5883\u3002\u76f8\u6bd4desktop\u6a21\u677f\uff0c\u5c06\u6574\u4e2a\u684c\u9762\u73af\u5883\u66ff\u6362\u4e3a\u4e86\u4e00\u4e2a headless chrome \u6d4f\u89c8\u5668\uff0c\u63d0\u9ad8\u4e86\u8d44\u6e90\u5229\u7528\u6548\u7387\u3002 \u8fd9\u4e2a\u4f8b\u5b50\u4f7f\u7528 browser_use \u6846\u67b6\u7f16\u5199\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684 Agent\uff0c\u8be5 Agent \u901a\u8fc7 OpenAI \u534f\u8bae\u8c03\u7528\u4e86\u963f\u91cc\u4e91\u767e\u8054\u5e73\u53f0\u4e0a\u7684 qwen-plus \u5927\u6a21\u578b\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8981\u4f53\u9a8c\u8be5\u5b9e\u4f8b\u60a8\u9700\u8981\u5728\u767e\u70bc\u5e73\u53f0\u4e0a\u521b\u5efa\u4e00\u4e2a API Key \u5e76\u914d\u7f6e\u4ee5\u4e0b\u73af\u5883\u53d8\u91cf\uff1a export LLM_API_KEY=sk-********* export LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1 \u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u5982\u4f55\u4ece\u6c99\u7bb1\u4e2d\u83b7\u53d6\u6d4f\u89c8\u5668 session \u5e76\u8ba9 Agent \u4f7f\u7528\u4ee5\u6267\u884c\u4efb\u52a1 import asyncio import os import time from browser_use import Agent, BrowserSession from browser_use.llm import ChatOpenAI from e2b_code_interpreter import Sandbox async def screenshot(agent: Agent): try: print(\"\u5f00\u59cb\u622a\u56fe...\") page = await agent.browser_session.get_current_page() screenshot_bytes = await page.screenshot(full_page=True, type='png') screenshots_dir = os.path.join(\".\", \"screenshots\") os.makedirs(screenshots_dir, exist_ok=True) screenshot_path = os.path.join(screenshots_dir, f\"{time.time()}.png\") with open(screenshot_path, \"wb\") as f: f.write(screenshot_bytes) print(f\"\u622a\u56fe\u5df2\u4fdd\u5b58\u81f3 {screenshot_path}\") except Exception as e: print(f\"\u622a\u56fe\u5931\u8d25: {e}\") async def main(): # \u521b\u5efa E2B \u6c99\u7bb1\u5b9e\u4f8b sandbox = Sandbox.create(api_key=\"GG\", template=\"browser\") try: # \u521b\u5efa Browser-use \u4f1a\u8bdd browser_session = BrowserSession(cdp_url=f\"https://api.{sandbox.sandbox_domain}/browser/{sandbox.sandbox_id}\") # \u4f7f\u7528 cdp \u534f\u8bae\u8fde\u63a5\u8fdc\u7a0b\u6c99\u7bb1\u4e2d\u7684\u6d4f\u89c8\u5668 await browser_session.start() print(\"Browser-use \u4f1a\u8bdd\u521b\u5efa\u6210\u529f\") # \u521b\u5efa AI Agent agent = Agent( task=\"\"\" \u4ece\u963f\u91cc\u4e91 ACS \u4ea7\u54c1\u8ba1\u8d39\u5b98\u65b9\u6587\u6863\uff08https://help.aliyun.com/zh/cs/product-overview/billing/\uff09\u8fdb\u5165\u8ba1\u8d39\u8bf4\u660e\uff0c\u603b\u7ed3\u4e0d\u540c\u5730\u57df\u3001\u8ba1\u7b97\u7c7b\u578b\u3001\u7b97\u529b\u8d28\u91cf\u7684\u8d39\u7528\u5dee\u522b \"\"\", llm=ChatOpenAI( api_key=os.getenv(\"LLM_API_KEY\"), base_url=os.getenv(\"LLM_BASE_URL\"), model=\"qwen-plus\", temperature=1, ), browser_session=browser_session, ) # \u8fd0\u884c Agent \u4efb\u52a1 print(\"\u5f00\u59cb\u6267\u884c Agent \u4efb\u52a1...\") await agent.run( on_step_end=screenshot, # \u5728\u6bcf\u4e2a\u6b65\u9aa4\u7ed3\u675f\u65f6\u8c03\u7528 screenshot \u622a\u56fe ) # \u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd await browser_session.close() print(\"\u4efb\u52a1\u6267\u884c\u5b8c\u6210\") finally: # \u6e05\u7406\u6c99\u7bb1\u8d44\u6e90 sandbox.kill() print(\"\u6c99\u7bb1\u8d44\u6e90\u5df2\u6e05\u7406\") if __name__ == \"__main__\": asyncio.run(main()) \u8fd0\u884c\u811a\u672c\u540e\uff0c\u5728\u7ec8\u7aef\u4e0a\u53ef\u4ee5\u770b\u5230\u5927\u6a21\u578b\u601d\u8003\u3001\u6267\u884c\u7684\u8fc7\u7a0b\u3002\u6bcf\u4e00\u6b65\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u90fd\u4f1a\u622a\u56fe\u4fdd\u5b58\u5728\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684 screenshot \u5b50\u76ee\u5f55\u4e0b\u3002","title":"\u5728ACS\u96c6\u7fa4\u4e2d\u4f7f\u7528 E2B \u7ba1\u7406\u5b89\u5168\u6c99\u7bb1"},{"location":"#acs-e2b","text":"","title":"\u5728ACS\u96c6\u7fa4\u4e2d\u4f7f\u7528 E2B \u7ba1\u7406\u5b89\u5168\u6c99\u7bb1"},{"location":"#_1","text":"E2B \u662f\u4e00\u4e2a\u6d41\u884c\u7684\u5f00\u6e90\u5b89\u5168\u6c99\u7bb1\u6846\u67b6\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u7b80\u5355\u6613\u7528\u7684 Python \u4e0e JavaScript SDK \u4f9b\u7528\u6237\u5bf9\u5b89\u5168\u6c99\u7bb1\u8fdb\u884c\u521b\u5efa\u3001\u67e5\u8be2\u3001\u6267\u884c\u4ee3\u7801\u3001\u8bf7\u6c42\u7aef\u53e3\u7b49\u64cd\u4f5c\u3002 acs-sandbox-manager\u7ec4\u4ef6\u662f\u4e00\u4e2a\u517c\u5bb9 E2B \u534f\u8bae\u7684\u540e\u7aef\u5e94\u7528\uff0c\u4f7f\u7528\u6237\u5728\u4efb\u4f55 K8s \u96c6\u7fa4\u4e2d\u4e00\u952e\u642d\u5efa\u4e00\u4e2a\u6027\u80fd\u5ab2\u7f8e\u539f\u751f E2B \u7684\u6c99\u7bb1\u57fa\u7840\u8bbe\u65bd\u3002 \u672c\u670d\u52a1\u63d0\u4f9b\u4e86\u5728ACS \u96c6\u7fa4\u4e2d\u5feb\u901f\u642d\u5efa\u5b89\u5168\u6c99\u7bb1\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u652f\u6301\u4f7f\u7528 E2B \u534f\u8bae\u8fdb\u884c\u4ea4\u4e92\u3002","title":"\u6982\u8ff0"},{"location":"#_2","text":"\u6807\u51c6\u7684 E2B \u534f\u8bae\u9700\u8981\u4e00\u4e2a\u57df\u540d\uff08E2B_DOMAIN\uff09\u6765\u6307\u5b9a\u540e\u7aef\u670d\u52a1\u3002\u4e3a\u6b64\uff0c\u60a8\u9700\u8981\u51c6\u5907\u4e00\u4e2a\u81ea\u5df1\u7684\u57df\u540d\u3002 E2B \u5ba2\u6237\u7aef\u5fc5\u987b\u901a\u8fc7 HTTPS \u534f\u8bae\u8bf7\u6c42\u540e\u7aef\uff0c\u5e76\u4e14\u6bcf\u6b21\u8bf7\u6c42\u7684\u5b50\u57df\u540d\u90fd\u53ef\u80fd\u4e0d\u540c\uff0c\u56e0\u6b64\u8fd8\u9700\u8981\u4e3a\u670d\u52a1\u7533\u8bf7\u4e00\u4e2a\u901a\u914d\u7b26\u8bc1\u4e66\u3002","title":"\u524d\u63d0\u51c6\u5907"},{"location":"#_3","text":"\u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u57df\u540d\uff0c\u53ef\u4ee5\u53c2\u8003\u6587\u6863 \u57df\u540d\u6ce8\u518c\u5feb\u901f\u5165\u95e8 \u6ce8\u518c\u4e00\u4e2a\u81ea\u5df1\u7684\u57df\u540d\u3002 \u5982\u679c\u60a8\u7684\u670d\u52a1\u90e8\u7f72\u5728\u4e2d\u56fd\u5185\u5730\uff0c\u8fd8\u9700\u8981\u4e3a\u57df\u540d\u8fdb\u884c\u5907\u6848\uff0c\u53c2\u8003\u6587\u6863\uff1a \u57df\u540d\u5907\u6848 \u3002","title":"\u51c6\u5907\u57df\u540d"},{"location":"#_4","text":"\u5728\u751f\u4ea7\u573a\u666f\u4e0b\uff0c\u63a8\u8350\u60a8\u53c2\u8003\u6587\u6863 \u8d2d\u4e70\u6b63\u5f0f\u8bc1\u4e66 \u7533\u8bf7\u4e00\u4e2a\u6b63\u5f0f\u7684\u901a\u914d\u7b26\u57df\u540d\u8bc1\u4e66\u3002 \u5728\u6d4b\u8bd5\u573a\u666f\u4e0b\uff0c\u60a8\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u6b65\u9aa4\u901a\u8fc7 Let's Encrypt \u7533\u8bf7\u4e00\u4e2a\u514d\u8d39\u7684\u6d4b\u8bd5\u8bc1\u4e66\u3002 1. \u901a\u8fc7\u7cfb\u7edf\u7684\u5305\u7ba1\u7406\u5668\uff08brew\u3001snap \u7b49\uff09\u5b89\u88c5 certbot\uff0c\u66f4\u591a\u5b89\u88c5\u4fe1\u606f\u8bf7\u67e5\u770b \u5b98\u65b9\u6587\u6863 \u3002 2. \u53c2\u8003\u4ee5\u4e0b\u547d\u4ee4\uff0c\u4fee\u6539 -d \u4e0e --email \u7684\u53c2\u6570\u4e3a\u6cdb\u57df\u540d*.your.domain.cn \u7533\u8bf7\u901a\u914d\u7b26\u8bc1\u4e66\u3002\u8bf7\u6839\u636e\u547d\u4ee4\u7684\u63d0\u793a\u8fdb\u884c\u9a8c\u8bc1\u64cd\u4f5c\u3002 $ sudo certbot certonly \\ --manual \\ --preferred-challenges=dns \\ --email your-email@example.com \\ --server https://acme-v02.api.letsencrypt.org/directory \\ --agree-tos \\ -d \"*.your.domain.cn\" \u5bfc\u51fa\u8bc1\u4e66 $ sudo cp /etc/letsencrypt/live/your.domain/fullchain.pem ./fullchain.pem $ sudo cp /etc/letsencrypt/live/your.domain/privkey.pem ./privkey.pem","title":"\u83b7\u53d6\u6cdb\u57df\u540d\u901a\u914d\u7b26\u8bc1\u4e66"},{"location":"#_5","text":"\u6253\u5f00\u8ba1\u7b97\u5de2\u670d\u52a1 \u90e8\u7f72\u94fe\u63a5 \u586b\u5199\u76f8\u5173\u90e8\u7f72\u53c2\u6570\u3001\u9009\u62e9\u90e8\u7f72\u5730\u57df\u3001ACS\u96c6\u7fa4\u7684Service CIDR, \u4e13\u6709\u7f51\u7edc\u914d\u7f6e \u586b\u5199E2B \u57df\u540d\u914d\u7f6e\uff0cE2B\u7684\u8bbf\u95ee\u57df\u540d\u914d\u7f6e\u4e3a\u4e0a\u8ff0\u524d\u63d0\u51c6\u5907\u9636\u6bb5\u7684\u57df\u540d\uff0c TLS \u8bc1\u4e66\u9009\u62e9fullchain.pem\u6587\u4ef6 TLS \u8bc1\u4e66\u79c1\u94a5\u9009\u62e9privkey.pem\u6587\u4ef6 4.\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u70b9\u51fb\u786e\u8ba4\u8ba2\u5355","title":"\u90e8\u7f72\u6d41\u7a0b"},{"location":"#_6","text":"\u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a\u5bf9\u5e94\u7684ACS\u96c6\u7fa4\uff0cACS\u96c6\u7fa4\u4e2d\u5728sandbox-system\u547d\u540d\u7a7a\u95f4\u4e0b\u6709sandbox-manager\u7684Deployment\uff0c\u7528\u4e8e\u7ba1\u7406\u6c99\u7bb1 \u521b\u5efa\u51fa\u6765\u7684\u6c99\u7bb1\uff0c\u4f1a\u5728default \u547d\u540d\u7a7a\u95f4\u4e0b","title":"\u4f7f\u7528\u6c99\u7bb1"},{"location":"#_7","text":"\u96c6\u7fa4\u4e2d\u4f7f\u7528MSE \u7f51\u5173\u4f5c\u4e3aIngress\uff0c\u5728 MSE\u63a7\u5236\u53f0 \u627e\u5230ACS\u96c6\u7fa4\u521b\u5efa\u51fa\u6765\u7684\u7f51\u5173\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u7b7e\u6765\u67e5\u627e \u83b7\u53d6\u5230MSE\u7f51\u5173\u7684\u516c\u7f51\u57df\u540d \u8bf7\u5c06\u4e3b\u673a\u8bb0\u5f55 *.your.domain.cn \u4ee5 CNAME \u8bb0\u5f55\u7c7b\u578b\u89e3\u6790\u5230\u5bf9\u5e94\u57df\u540d\u3002","title":"\u914d\u7f6e\u57df\u540d\u7684\u89e3\u6790"},{"location":"#demo","text":"acs-sandbox-manager \u7ec4\u4ef6\u6682\u65f6\u53ea\u652f\u6301\u4ee5\u4e0b\u4e09\u4e2a\u5185\u7f6e\u7684\u6a21\u677f\uff1a 1. code-interpreter\uff1aE2B \u5b98\u65b9\u7684 code-interpreter \u955c\u50cf\uff0c\u53ef\u4ee5\u6267\u884c Python \u4ee3\u7801\u3002 2. desktop\uff1aE2B \u5b98\u65b9\u7684 desktop \u955c\u50cf\uff0c\u7528\u4e8e\u901a\u8fc7 e2b_desktop \u5e93\u8fdc\u7a0b\u64cd\u4f5c\u56fe\u5f62\u684c\u9762\u3002 3. browser\uff1aGoogle \u5b98\u65b9\u7684 headless-shell \u955c\u50cf\uff0c\u4e3a browser_use \u7b49\u5e94\u7528\u63d0\u4f9b\u4e86 Chrome \u6d4f\u89c8\u5668\u73af\u5883\u3002","title":"\u4f7f\u7528\u6c99\u7bb1demo"},{"location":"#_8","text":"export E2B_DOMAIN=your.domain.cn","title":"\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf"},{"location":"#_9","text":"\u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u521b\u5efa\u6c99\u7bb1\u3001\u6267\u884c\u4ee3\u7801\u3001\u8bfb\u5199\u6587\u4ef6\u3001\u9500\u6bc1\u6c99\u7bb1\u7b49\u57fa\u672c\u529f\u80fd\u3002 import os # Import the E2B SDK from e2b_code_interpreter import Sandbox # Create a sandbox using the E2B Python SDK sbx = Sandbox.create(template=\"code-interpreter\", timeout=300) print(f\"sandbox id: {sbx.sandbox_id}\") def execute_python_code(s: Sandbox, code: str): # Execute Python code inside the sandbox execution = s.run_code(code) if execution.error: print(f\"Error executing code: {execution.error}\") else: print(execution.logs.stdout) execute_python_code(sbx, \"print('hello world')\") execute_python_code(sbx, \"a = 1\") execute_python_code(sbx, \"b = 2\") execute_python_code(sbx, \"print(a + b)\") execute_python_code(sbx, \"\"\" def bubble_sort(arr): n = len(arr) # \u521b\u5efa\u6570\u7ec4\u526f\u672c\uff0c\u907f\u514d\u4fee\u6539\u539f\u6570\u7ec4 sorted_arr = arr.copy() # \u5916\u5c42\u5faa\u73af\u63a7\u5236\u6392\u5e8f\u8f6e\u6570 for i in range(n): # \u6807\u8bb0\u672c\u8f6e\u662f\u5426\u53d1\u751f\u4ea4\u6362 swapped = False # \u5185\u5c42\u5faa\u73af\u8fdb\u884c\u76f8\u90bb\u5143\u7d20\u6bd4\u8f83 for j in range(0, n - i - 1): # \u5982\u679c\u524d\u4e00\u4e2a\u5143\u7d20\u5927\u4e8e\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u5219\u4ea4\u6362 if sorted_arr[j] > sorted_arr[j + 1]: sorted_arr[j], sorted_arr[j + 1] = sorted_arr[j + 1], sorted_arr[j] swapped = True # \u5982\u679c\u672c\u8f6e\u6ca1\u6709\u53d1\u751f\u4ea4\u6362\uff0c\u8bf4\u660e\u6570\u7ec4\u5df2\u7ecf\u6709\u5e8f\uff0c\u53ef\u4ee5\u63d0\u524d\u7ed3\u675f if not swapped: break return sorted_arr print(bubble_sort([1,6,4,2,3,7,5])) \"\"\") # List files in the sandbox try: # Read local file relative to the current working directory with open(os.path.abspath(__file__), \"rb\") as file: sbx.files.write(\"/home/user/my-file\", file) file_content = sbx.files.read(\"/home/user/my-file\") print(file_content) except Exception as e: # Print the full stack trace for debugging import traceback traceback.print_exc() print(f\"Error listing files: {e}\") raise e finally: sbx.kill() print(f\"sandbox {sbx.sandbox_id} killed\") \u9884\u671f\u8f93\u51fa sandbox id: code-interpreter-5df5b8dd48-dpxjb ['hello world\\n'] [] [] ['3\\n'] ['[1, 2, 3, 4, 5, 6, 7]\\n']","title":"\u6267\u884c\u4ee3\u7801"},{"location":"#_10","text":"\u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u7533\u8bf7\u6c99\u7bb1\u3001\u542f\u52a8\u7a0b\u5e8f\u3001\u952e\u76d8\u8f93\u5165\u3001\u9500\u6bc1\u6c99\u7bb1\u7b49\u57fa\u672c\u529f\u80fd\u3002 \u6a21\u677f\u4ec5\u5185\u7f6e\u4e86\u4e00\u4e2a\u672a\u4f18\u5316\u7684\u684c\u9762\u73af\u5883\uff0c\u542f\u52a8\u65f6\u4f1a\u6709\u4e00\u4e9b\u5f39\u7a97\uff0c\u9700\u8981\u901a\u8fc7\u4e32\u6d41\u624b\u52a8\u5173\u95ed\u540e\u518d\u6267\u884c Chrome \u8bbf\u95ee\u767e\u5ea6\u7684\u81ea\u52a8\u5316\u64cd\u4f5c\u3002 import time from e2b_desktop import Sandbox # Create a new desktop sandbox desktop = Sandbox.create(api_key=\"GG\", template=\"desktop\") print(f\"sandboxId: {desktop.sandbox_id}\") # Launch an application desktop.launch('google-chrome') # or vscode, firefox, etc. print(\"waiting 5 seconds for desktop launching\") time.sleep(5) # Stream the application's window # Note: There can be only one stream at a time # You need to stop the current stream before streaming another application desktop.stream.start( # window_id=desktop.get_current_window_id(), # if not provided the whole desktop will be streamed require_auth=True ) # Get the stream auth key auth_key = desktop.stream.get_auth_key() # Print the stream URL print('Stream URL:', desktop.stream.get_url(auth_key=auth_key)) input(\"select the address bar and press ENTER to visit baidu.com\") desktop.write(\"www.baidu.com\") time.sleep(0.5) desktop.press(\"enter\") input(\"press ENTER to exit\") # Kill the sandbox after the tasks are finished desktop.kill() \u7b49\u5f85\u684c\u9762\u4e32\u6d41\u542f\u52a8 sandboxId: desktop-7c84c88b8-tpjmg waiting 5 seconds for desktop launching Stream URL: https://6080-desktop-7c84c88b8-tpjmg.your.domain/vnc.html?autoconnect=true&resize=scale&password=***** select the address bar and press ENTER to visit baidu.com \u8bbf\u95ee Stream URL\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6253\u5f00\u4e86 Chrome \u7684 Linux \u684c\u9762 \u56de\u5230\u7ec8\u7aef\u6572\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u684c\u9762\u81ea\u52a8\u6253\u5f00\u4e86\u767e\u5ea6\u3002","title":"\u63a7\u5236\u684c\u9762"},{"location":"#_11","text":"\u5185\u7f6e\u6a21\u677fbrowser\u662f\u4ee5 E2B Sandbox \u5f62\u5f0f\u900f\u51fa\uff0c\u517c\u5bb9\u5f00\u6e90\u9879\u76eebrowser_use\u7684\u6d4f\u89c8\u5668\u73af\u5883\u3002\u76f8\u6bd4desktop\u6a21\u677f\uff0c\u5c06\u6574\u4e2a\u684c\u9762\u73af\u5883\u66ff\u6362\u4e3a\u4e86\u4e00\u4e2a headless chrome \u6d4f\u89c8\u5668\uff0c\u63d0\u9ad8\u4e86\u8d44\u6e90\u5229\u7528\u6548\u7387\u3002 \u8fd9\u4e2a\u4f8b\u5b50\u4f7f\u7528 browser_use \u6846\u67b6\u7f16\u5199\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684 Agent\uff0c\u8be5 Agent \u901a\u8fc7 OpenAI \u534f\u8bae\u8c03\u7528\u4e86\u963f\u91cc\u4e91\u767e\u8054\u5e73\u53f0\u4e0a\u7684 qwen-plus \u5927\u6a21\u578b\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8981\u4f53\u9a8c\u8be5\u5b9e\u4f8b\u60a8\u9700\u8981\u5728\u767e\u70bc\u5e73\u53f0\u4e0a\u521b\u5efa\u4e00\u4e2a API Key \u5e76\u914d\u7f6e\u4ee5\u4e0b\u73af\u5883\u53d8\u91cf\uff1a export LLM_API_KEY=sk-********* export LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1 \u4ee5\u4e0b\u811a\u672c\u6f14\u793a\u4e86\u5982\u4f55\u4ece\u6c99\u7bb1\u4e2d\u83b7\u53d6\u6d4f\u89c8\u5668 session \u5e76\u8ba9 Agent \u4f7f\u7528\u4ee5\u6267\u884c\u4efb\u52a1 import asyncio import os import time from browser_use import Agent, BrowserSession from browser_use.llm import ChatOpenAI from e2b_code_interpreter import Sandbox async def screenshot(agent: Agent): try: print(\"\u5f00\u59cb\u622a\u56fe...\") page = await agent.browser_session.get_current_page() screenshot_bytes = await page.screenshot(full_page=True, type='png') screenshots_dir = os.path.join(\".\", \"screenshots\") os.makedirs(screenshots_dir, exist_ok=True) screenshot_path = os.path.join(screenshots_dir, f\"{time.time()}.png\") with open(screenshot_path, \"wb\") as f: f.write(screenshot_bytes) print(f\"\u622a\u56fe\u5df2\u4fdd\u5b58\u81f3 {screenshot_path}\") except Exception as e: print(f\"\u622a\u56fe\u5931\u8d25: {e}\") async def main(): # \u521b\u5efa E2B \u6c99\u7bb1\u5b9e\u4f8b sandbox = Sandbox.create(api_key=\"GG\", template=\"browser\") try: # \u521b\u5efa Browser-use \u4f1a\u8bdd browser_session = BrowserSession(cdp_url=f\"https://api.{sandbox.sandbox_domain}/browser/{sandbox.sandbox_id}\") # \u4f7f\u7528 cdp \u534f\u8bae\u8fde\u63a5\u8fdc\u7a0b\u6c99\u7bb1\u4e2d\u7684\u6d4f\u89c8\u5668 await browser_session.start() print(\"Browser-use \u4f1a\u8bdd\u521b\u5efa\u6210\u529f\") # \u521b\u5efa AI Agent agent = Agent( task=\"\"\" \u4ece\u963f\u91cc\u4e91 ACS \u4ea7\u54c1\u8ba1\u8d39\u5b98\u65b9\u6587\u6863\uff08https://help.aliyun.com/zh/cs/product-overview/billing/\uff09\u8fdb\u5165\u8ba1\u8d39\u8bf4\u660e\uff0c\u603b\u7ed3\u4e0d\u540c\u5730\u57df\u3001\u8ba1\u7b97\u7c7b\u578b\u3001\u7b97\u529b\u8d28\u91cf\u7684\u8d39\u7528\u5dee\u522b \"\"\", llm=ChatOpenAI( api_key=os.getenv(\"LLM_API_KEY\"), base_url=os.getenv(\"LLM_BASE_URL\"), model=\"qwen-plus\", temperature=1, ), browser_session=browser_session, ) # \u8fd0\u884c Agent \u4efb\u52a1 print(\"\u5f00\u59cb\u6267\u884c Agent \u4efb\u52a1...\") await agent.run( on_step_end=screenshot, # \u5728\u6bcf\u4e2a\u6b65\u9aa4\u7ed3\u675f\u65f6\u8c03\u7528 screenshot \u622a\u56fe ) # \u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd await browser_session.close() print(\"\u4efb\u52a1\u6267\u884c\u5b8c\u6210\") finally: # \u6e05\u7406\u6c99\u7bb1\u8d44\u6e90 sandbox.kill() print(\"\u6c99\u7bb1\u8d44\u6e90\u5df2\u6e05\u7406\") if __name__ == \"__main__\": asyncio.run(main()) \u8fd0\u884c\u811a\u672c\u540e\uff0c\u5728\u7ec8\u7aef\u4e0a\u53ef\u4ee5\u770b\u5230\u5927\u6a21\u578b\u601d\u8003\u3001\u6267\u884c\u7684\u8fc7\u7a0b\u3002\u6bcf\u4e00\u6b65\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u90fd\u4f1a\u622a\u56fe\u4fdd\u5b58\u5728\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684 screenshot \u5b50\u76ee\u5f55\u4e0b\u3002","title":"\u63a7\u5236\u6d4f\u89c8\u5668"}]}